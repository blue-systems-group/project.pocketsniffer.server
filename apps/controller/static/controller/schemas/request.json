{
    "id": "http://pocketsniffer.phone-lab.org/static/schemas/request#",
    "$schema": "http://json-schema.org/draft-04/schema#",
    "title": "Request",
    "description": "A request sent from controller to router, or from router to sniffer client.",
    "type": "object",
    "required": ["action"],
    "properties": {
        "action": {
            "description": "Action that is supposed to be performed by receiver.",
            "type": "string",
            "enum": ["collect", "apConfig", "clientReassoc", "clientMeasure"]
        },
        "apStatus": {
            "description": "Whether or not collect AP status, e.g., current channel, tx power, etc.",
            "type": "boolean"
        },
        "apScan": {
            "description": "Whether or not collect AP scan results.",
            "type": "boolean"
        },
        "stationDump": {
            "description": "Whether or not collect associated station information.",
            "type": "boolean"
        },
        "clientScan": {
            "description": "Whether or not collect client scan results.",
            "type": "boolean"
        },
        "clientTraffic": {
            "description": "Whether or not collect client traffic (by turning client into monitor mode).",
            "type": "boolean"
        },
        "trafficChannel": {
            "description": "If collect client traffic, which channel to listen.",
            "type": "array",
            "minItems": 1,
            "items": {
                "type": "integer",
                "minimum": 1,
                "maxmum": 165
            },
            "uniqueItems": true
        },
        "band2g": {
            "description": "2.4 GHz band configuration.",
            "$ref": "#/definitions/bandConfiguration"
        },
        "band5g": {
            "description": "2.4 GHz band configuration.",
            "$ref": "#/definitions/bandConfiguration"
        },
        "client": {
            "description": "The client that this request should be redirected to.",
            "type": "string",
            "pattern": "^([0-9A-Fa-f]{2}[:]){5}([0-9A-Fa-f]{2})$"
        },
        "newBSSID": {
            "description": "New AP BSSID that the client should associate to.",
            "type": "string",
            "pattern": "^([0-9A-Fa-f]{2}[:]){5}([0-9A-Fa-f]{2})$"
        },
        "measurementType": {
            "description": "Which type of measurement that the client should perform.",
            "type": "string",
            "enum": ["latency", "bandwidth"]
        }
    },
    "definitions": {
        "bandConfiguration": {
            "required": ["enable"],
            "properties": {
                "enable": {
                    "description": "Whether to enable this band",
                    "type": "boolean"
                },
                "channel": {
                    "description": "Channel to use in this band.",
                    "type": "integer"
                },
                "txPower" : {
                    "description": "Tx power (in dBm) to use in this band.",
                    "type": "integer"
                }
            }
        }
    }
}
